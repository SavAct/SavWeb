"use strict";(globalThis["webpackChunksavactapp"]=globalThis["webpackChunksavactapp"]||[]).push([[165],{87165:(e,t,l)=>{l.r(t),l.d(t,{default:()=>q});var n=l(59835),a=l(86970),o=l(61957);const i={class:"q-ma-md"},r={class:"row justify-center items-center"},s={class:"row justify-center items-center q-mt-md"},c={class:"q-mx-sm q-mt-md"},u=(0,n._)("div",{class:"q-mt-md"},null,-1);function d(e,t,l,d,v,f){const m=(0,n.up)("q-btn"),b=(0,n.up)("q-spinner-grid"),g=(0,n.up)("q-table");return(0,n.wg)(),(0,n.iD)("div",i,[(0,n._)("div",r,(0,a.zw)(e.t("tokenDistributionNote")),1),(0,n._)("div",s,[(0,n.Wm)(m,{dense:"",flat:"",icon:"refresh",label:e.t("loadBalances"),size:"md",onClick:e.getBalances,class:"send-btn",disable:e.loading},null,8,["label","onClick","disable"]),(0,n.wy)((0,n.Wm)(b,{class:"q-ml-lg",size:"2em"},null,512),[[o.F8,e.loading]])]),(0,n.Wm)(m,{dense:"",flat:"",icon:"refresh",label:e.t("distributedTokens"),size:"md",onClick:e.getSold,class:"send-btn"},null,8,["label","onClick"]),(0,n._)("div",c,(0,a.zw)(e.goalText),1),(0,n.Wm)(g,{title:e.tableTitle,rows:e.rows,columns:e.columns,"row-key":"name","no-data-label":e.t("clickForBalances")},null,8,["title","rows","columns","no-data-label"]),u])}var v=l(60499),f=l(27712),m=l(5980),b=l(62659),g=l(17779),p=function(e,t,l,n){function a(e){return e instanceof l?e:new l((function(t){t(e)}))}return new(l||(l=Promise))((function(l,o){function i(e){try{s(n.next(e))}catch(t){o(t)}}function r(e){try{s(n["throw"](e))}catch(t){o(t)}}function s(e){e.done?l(e.value):a(e.value).then(i,r)}s((n=n.apply(e,t||[])).next())}))};const h=(0,n.aZ)({name:"page-token-distribution",setup(){const e=(0,b.r)(),t=(0,n.Fl)((()=>e.allConnects)),l=(0,n.Fl)((()=>e.selectedConnect)),a=(0,v.iH)(!1),o=(0,v.iH)("eos"),i=(0,v.iH)([]),r=(0,v.iH)(),s=(0,v.iH)(),c=(0,v.iH)(),u="SAVACT",d="savact",h="token.savact",w=[d,h,"savactsavact","savactsavweb","savactecosys","savactmarket","savactpeople","savactardent","olookei1oolo"];let k=(0,v.iH)([]),y=(0,v.iH)(0);function _(){return p(this,void 0,void 0,(function*(){const e=(0,m.GetConnectByChainId)(o.value,t.value);if(void 0==e)return void g.log("No connection found");let l={json:"true",code:d,scope:d,table:"stat",key_type:"",lower_bound:"",upper_bound:"",index_position:"",limit:1,reverse:!1,show_payer:!1},n=yield e.get_table_rows(l);if(void 0!=n&&"rows"in n&&n.rows.length>0&&"sold"in n.rows[0]){let e=n.rows[0];if(r.value=Number(e.sold),c.value="","stars"in e){k.value=e.stars;let t=0;for(;t<k.value.length;++t)if(g.log("sold.value",r.value),g.log("mark.value",k.value[t].mark),r.value<Number(k.value[t].mark))break;t==k.value.length?c.value="The sale is over.":c.value=`The next goal is ${(k.value[t].mark/1e4).toString()} SAVACT. Current state: ${Math.floor(r.value/k.value[t].mark*1e3)/10}%.`}s.value=`${(r.value/1e4).toString()} ${u}`}}))}function C(){return p(this,void 0,void 0,(function*(){if(a.value)return;a.value=!0;const e=(0,m.GetConnectByChainId)(o.value,t.value);if(void 0==e)return g.log("No connection found"),void(a.value=!1);i.value=[];try{let t,l={code:h,table:"accounts",lower_bound:void 0,upper_bound:void 0,limit:500,reverse:!1,show_payer:!1};do{if(t=yield e.get_table_by_scope(l),void 0!=t&&"rows"in t&&t.rows.length>0){let e=t.rows.map((e=>({name:e.scope,balance:void 0})));i.value.push(...e),l.lower_bound=t.more}}while(void 0!=t&&"more"in t&&""!=t.more);i.value=i.value.filter((e=>{for(let t of w)if(e.name==t)return!1;return!0}));for(let n of i.value)if(t=yield e.get_currency_balance(l.code,n.name,u),void 0!=t&&"length"in t&&t.length>0){let e=t[0].indexOf(" "+u);if(e>0){let l=t[0].substring(0,e);l.length>0&&(n.balance=parseFloat(l))}}}catch(l){g.log("Cannot send the request",l)}finally{a.value=!1}}))}function T(e){if(void 0==e||e<=0)return-1===e?"black":"grey";let t="";return e<=3e3?(t=e<=600?`#${(10*Math.floor(25.5*e/600)).toString(16).replace("-","0").padStart(2,"0")}ff00`:`#ff${(255-10*Math.floor(25.5*(e-600)/2300)).toString(16).replace("-","0").padStart(2,"0")}00`,t):"red"}const S=[{name:"name",required:!0,label:"Account",align:"left",field:e=>e.name,format:e=>`${e}`,sortable:!0},{name:"balance",align:"center",label:u,field:"balance",sortable:!0,sortOrder:"ad"}];return{allConnects:t,selectedConnect:l,loading:a,pingColor:T,getBalances:C,tableTitle:s,columns:S,rows:i,getSold:_,steps:y,goalText:c,t:(0,f.QT)({useScope:"global"}).t.bind(this)}}});var w=l(11639),k=l(68879),y=l(93040),_=l(31746),C=l(69984),T=l.n(C);const S=(0,w.Z)(h,[["render",d]]),q=S;T()(h,"components",{QBtn:k.Z,QSpinnerGrid:y.Z,QTable:_.Z})}}]);