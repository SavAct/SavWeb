"use strict";(globalThis["webpackChunksavactapp"]=globalThis["webpackChunksavactapp"]||[]).push([[921],{41382:(e,t,o)=>{o.r(t),o.d(t,{default:()=>we});var l=o(59835),a=o(86970);const i={class:"row justify-between reverse q-mt-md"},n={class:"col-12 col-sm-5 col-md-4 q-px-sm"},s={class:"row justify-between"},r={class:"q-pr-sm text-h6 q-mb-sm"},u={class:"col-12 text-h6 text-left"},c={class:"col-12 text-left"},d={class:"q-gutter-sm"},m={key:0,class:"q-mt-sm"},p={class:"col-12 col-sm-7 col-md-8 row justify-center"},v={class:"full-width"},w={class:"row"},b={class:"q-mb-sm col-grow q-pr-sm"},f={class:"col-auto"},h={key:0},y={class:"text-no-wrap"},g={class:"q-mb-md"},q=(0,l._)("span",null,":  ",-1),T={class:"full-width"},_={key:1},k=(0,l._)("br",null,null,-1),V={class:"full-width row flex-center q-gutter-sm"},C={class:"col q-pl-md"};function W(e,t,o,W,x,U){const z=(0,l.up)("q-btn"),H=(0,l.up)("q-btn-toggle"),S=(0,l.up)("q-icon"),I=(0,l.up)("q-card"),D=(0,l.up)("bar-graph"),F=(0,l.up)("pie-graph"),Z=(0,l.up)("vote-buttons"),A=(0,l.up)("remaining-time"),Q=(0,l.up)("time-view"),R=(0,l.up)("trx-tool-tip"),j=(0,l.up)("q-avatar"),O=(0,l.up)("q-td"),P=(0,l.up)("q-tr"),B=(0,l.up)("q-table"),E=(0,l.up)("symbol-dialog"),K=(0,l.up)("q-card-section"),N=(0,l.up)("q-card-actions"),M=(0,l.up)("q-dialog"),$=(0,l.up)("q-page"),G=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)($,{class:"justify-evenly",style:{position:"relative",height:"100%"}},{default:(0,l.w5)((()=>[(0,l._)("div",i,[(0,l._)("div",n,[(0,l.Wm)(I,{class:"card q-px-md q-pt-sm q-pb-md q-mb-md items-center"},{default:(0,l.w5)((()=>{var o,i;return[(0,l._)("div",s,[(0,l._)("div",r,(0,a.zw)(`${null===(i=null===(o=e.connect)||void 0===o?void 0:o.chainParams)||void 0===i?void 0:i.name} Network`),1),(0,l.Wm)(z,{size:"sm",class:"row q-px-sm q-py-none q-mb-md",onClick:t[0]||(t[0]=t=>e.showSymbol=!0),outline:""},{default:(0,l.w5)((()=>[(0,l._)("div",u,(0,a.zw)(e.symbol),1),(0,l._)("div",c,(0,a.zw)(e.tokenContract),1)])),_:1})]),(0,l._)("div",d,[(0,l._)("div",null,(0,a.zw)(e.t("graphTypeBy"))+":",1),(0,l.Wm)(H,{modelValue:e.switchCount,"onUpdate:modelValue":t[1]||(t[1]=t=>e.switchCount=t),class:"q-pa-none","no-caps":"",size:"sm",rounded:"",unelevated:"","toggle-color":"blue","text-color":"blue",style:{border:"1px solid #027be3"},options:[{label:e.t("fundingSum"),value:!1},{label:e.t("voteCount"),value:!0}]},null,8,["modelValue","options"]),(0,l.Wm)(S,{class:"cursor-pointer",size:"sm",name:"info",onClick:t[2]||(t[2]=t=>e.infoDialog=!0),clickable:""})]),e.hasUserTrx?((0,l.wg)(),(0,l.iD)("div",m,[(0,l._)("div",null,(0,a.zw)(e.t("voteFilter"))+":",1),(0,l.Wm)(H,{disable:!e.hasUserTrx,modelValue:e.activeFilter,"onUpdate:modelValue":t[3]||(t[3]=t=>e.activeFilter=t),class:"q-mt-sm","no-caps":"",size:"sm",rounded:"",unelevated:"","toggle-color":"blue","text-color":"blue",style:{border:"1px solid #027be3"},options:[{label:e.t("allVotes"),value:!1},{label:e.t("activeVotes"),value:!0}]},null,8,["disable","modelValue","options"])])):(0,l.kq)("",!0),(0,l.Wm)(H,{class:"q-mt-md full-width",modelValue:e.chartType,"onUpdate:modelValue":t[4]||(t[4]=t=>e.chartType=t),"toggle-color":"blue",options:[{value:"bar90",slot:"bar90"},{value:"bar",slot:"bar"},{value:"pie",slot:"pie"},{value:"donut",slot:"donut"}]},{bar90:(0,l.w5)((()=>[(0,l.Wm)(S,{name:"poll",style:{transform:"rotate(90deg)"}})])),bar:(0,l.w5)((()=>[(0,l.Wm)(S,{name:"poll"})])),pie:(0,l.w5)((()=>[(0,l.Wm)(S,{name:"pie_chart"})])),donut:(0,l.w5)((()=>[(0,l.Wm)(S,{name:"data_usage"})])),_:1},8,["modelValue"])]})),_:1})]),(0,l._)("div",p,["bar"==e.chartType||"bar90"==e.chartType?((0,l.wg)(),(0,l.j4)(D,{class:"q-mx-sm",data:e.voteData,key:e.graphUpdateKey[0],switchCount:e.switchCount,symbol:e.symbol,precision:e.precision,horizontal:"bar90"==e.chartType},null,8,["data","switchCount","symbol","precision","horizontal"])):"pie"==e.chartType||"donut"==e.chartType?((0,l.wg)(),(0,l.j4)(F,{class:"q-mx-sm",data:e.voteData,key:e.graphUpdateKey[1],switchCount:e.switchCount,symbol:e.symbol,precision:e.precision,donut:"donut"==e.chartType},null,8,["data","switchCount","symbol","precision","donut"])):(0,l.kq)("",!0)])]),(0,l.Wm)(B,{title:"Incomings",class:"q-mx-sm q-mb-md q-mt-sm card",rows:e.inRows,columns:e.inColumns,"row-key":e.rowKey,color:"amber",loading:e.loadingUpdateIn,"no-data-label":"Enter user accounts and click the update button to show data"},{top:(0,l.w5)((()=>[(0,l._)("div",v,[(0,l._)("div",w,[(0,l._)("div",b,[(0,l.Wm)(z,{icon:"bi-person",outline:"",round:"",size:"sm",onClick:t[5]||(t[5]=t=>e.showUser=!0)})]),(0,l._)("div",f,[(0,l.Wm)(Z,{poll:e.pubVote,recipient:e.user,onShowResult:t[6]||(t[6]=t=>e.updateIn()),loading:e.loadingUpdateIn,"update-icon":"update"},null,8,["poll","recipient","loading"])])]),e.hasUserTrx?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[e.isVoteOver?void 0!==e.limit?((0,l.wg)(),(0,l.iD)("div",_,[(0,l._)("span",null,(0,a.zw)(e.t("punishLimit"))+":  ",1),(0,l.Wm)(A,{modelValue:e.limit,"onUpdate:modelValue":t[9]||(t[9]=t=>e.limit=t),timeOverMsg:e.t("voteResultTimeEnd"),onTimeover:t[10]||(t[10]=t=>e.isTimeover=!0)},null,8,["modelValue","timeOverMsg"])])):(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",h,[(0,l._)("span",y,(0,a.zw)(e.t("voteEndTime")),1),(0,l._)("span",g,[q,(0,l.Wm)(A,{modelValue:e.voteEnd,"onUpdate:modelValue":t[7]||(t[7]=t=>e.voteEnd=t),timeOverMsg:e.t("timeIsOver"),onTimeover:t[8]||(t[8]=t=>e.isVoteOver=!0)},null,8,["modelValue","timeOverMsg"])]),(0,l._)("div",T,[(0,l._)("span",null,(0,a.zw)(e.t("punishTimeSpanSend"))+":  ",1),(0,l.Wm)(Q,{class:"col",showTime:e.decisionTime,valueClasses:"text-green"},null,8,["showTime"])])]))],64)):(0,l.kq)("",!0)])])),body:(0,l.w5)((t=>[(0,l.Wm)(P,{props:t,class:(0,a.C_)(["cursor-pointer",t.row.removed?e.brightStyle?"bg-grey":"bg-grey-10":""]),onClick:o=>e.onRowClick(t.row,!0)},{default:(0,l.w5)((()=>[(0,l.Wm)(R,{trx:t.row},null,8,["trx"]),(0,l.Wm)(O,{key:"type",props:t},{default:(0,l.w5)((()=>[(0,l.Wm)(j,{"text-color":"black",size:"md",color:e.colorStatus(t.row.time),icon:0==t.row.type?"shopping_cart":"poll"},null,8,["color","icon"])])),_:2},1032,["props"]),(0,l.Wm)(O,{key:"id",props:t},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(t.row.id),1)])),_:2},1032,["props"]),(0,l.Wm)(O,{key:"sender",props:t},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.shortAddress(t.row.sender)),1)])),_:2},1032,["props"]),(0,l.Wm)(O,{key:"fund",props:t},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(t.row.orifund),1),k,(0,l.Uk)((0,a.zw)(t.row.contract),1)])),_:2},1032,["props"]),(0,l.Wm)(O,{key:"vote",props:t,style:(0,a.j5)(`color: ${e.VoteColor[t.row.vote.choice.selected]}`)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(t.row.vote?(t.row.vote.choice.selected+1).toString():""),1)])),_:2},1032,["props","style"]),(0,l.Wm)(O,{key:"option",props:t},{default:(0,l.w5)((()=>{var o;return[(0,l.Uk)((0,a.zw)(t.row.vote?e.shortenText(e.pubVote&&"object"===typeof e.pubVote.public?null===(o=e.pubVote.public.options[t.row.vote.choice.selected])||void 0===o?void 0:o.option:t.row.vote.choice.msg):t.row.memo),1)]})),_:2},1032,["props"])])),_:2},1032,["props","class","onClick"])])),"no-data":(0,l.w5)((({message:e})=>[(0,l._)("div",V,[(0,l._)("span",null,(0,a.zw)(e),1)])])),_:1},8,["rows","columns","row-key","loading"]),(0,l.Wm)(E,{modelValue:e.showSymbol,"onUpdate:modelValue":t[11]||(t[11]=t=>e.showSymbol=t),contract:e.tokenContract,"onUpdate:contract":t[12]||(t[12]=t=>e.tokenContract=t),symbol:e.symbol,"onUpdate:symbol":t[13]||(t[13]=t=>e.symbol=t),connect:e.connect,precision:e.precision,"onUpdate:precision":t[14]||(t[14]=t=>e.precision=t)},null,8,["modelValue","contract","symbol","connect","precision"]),(0,l.Wm)(M,{modelValue:e.infoDialog,"onUpdate:modelValue":t[15]||(t[15]=t=>e.infoDialog=t)},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{class:"card"},{default:(0,l.w5)((()=>[(0,l.Wm)(K,{class:"q-pb-none row"},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{class:"col-auto",name:"info",size:"lg"}),(0,l._)("span",C,(0,a.zw)(e.t("voteResultInfo")),1)])),_:1}),(0,l.Wm)(N,{class:"q-pt-none",align:"right"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(z,{flat:"",label:"OK",color:"primary"},null,512),[[G]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(M,{modelValue:e.showUser,"onUpdate:modelValue":t[16]||(t[16]=t=>e.showUser=t)},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{class:"card"},{default:(0,l.w5)((()=>[(0,l.Wm)(K,{class:"row"},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{class:"col-auto q-mr-sm",name:"bi-person",size:"md"}),(0,l._)("div",{class:(0,a.C_)(["col-grow q-px-sm",e.user.length<=13?"text-h6":"text-subtitle2"])},(0,a.zw)(e.user),3)])),_:1}),(0,l.Wm)(N,{class:"q-pt-none",align:"right"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(z,{flat:"",label:"Close",color:"primary"},null,512),[[G]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}var x=o(60499),U=o(13022),z=o(52086),H=o(50674),S=o(72902),I=o(22759),D=o(89889),F=o(34594),Z=o(27712),A=o(6827),Q=o(62659),R=o(94345),j=o(65211),O=o(74544),P=o(28339),B=o(10818),E=o(3390),K=o(5980),N=o(47983),M=o(86350),$=o(8411),G=o(17779),L=function(e,t,o,l){function a(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,i){function n(e){try{r(l.next(e))}catch(t){i(t)}}function s(e){try{r(l["throw"](e))}catch(t){i(t)}}function r(e){e.done?o(e.value):a(e.value).then(n,s)}r((l=l.apply(e,t||[])).next())}))};const Y=(0,l.aZ)({name:"page-vote",components:{TrxToolTip:U["default"],PieGraph:z["default"],BarGraph:H["default"],SymbolDialog:S["default"],RemainingTime:I["default"],TimeView:D["default"],VoteButtons:F["default"]},setup(){const e=(0,E.b)(),t=(0,Q.r)(),o=(0,Z.QT)({useScope:"global"}).t.bind(this),a=(0,P.tv)(),i=(0,P.yj)(),n=i.query,s=(0,x.iH)("bar90"),r=(0,x.iH)(!1),u=(0,x.iH)(!1),c=(0,x.iH)(!1),d=(0,l.Fl)({get:()=>c.value,set:e=>{c.value=e,u.value=!1}}),m=(0,x.iH)(!1),p=(0,x.iH)(!1),v=(0,x.iH)([0,0]),w=(0,x.iH)(!1),b=(0,x.iH)("SAVACT"),f=(0,x.iH)("token.savact"),h=(0,x.iH)(4),y=(0,K.GetConnectByChainId)(n.chain,t.allConnects),g=(0,x.iH)(!1),q=(0,x.iH)("string"==typeof n.to?n.to:t.historyUserInput?t.historyUserInput:""),T=(0,l.Fl)({get:()=>q.value,set:e=>{q.value=e,((0,R.isNameValid)(e)||e.length>52&&j.b.isValidPublic(e))&&t.setHistoryUserInput(e)}}),_=Number(n.id);function k(){var e;const o=null===(e=t.user[T.value])||void 0===e?void 0:e.inHistory.find((e=>0!=e.type&&e.id==_));if(!o)return;const l=(0,O.stringToAsset)(o.fund);f.value=o.contract,b.value=l.symbol.name,h.value=l.symbol.precision;const a=Date.now()/1e3;return o.time>a?d.value=!1:o.time>1&&(d.value=!0),o.vote&&o.vote.end>a?m.value=!1:o.time>1&&(m.value=!0),o}"number"!=typeof _&&G.log("Error: Missing id in query",_);const V=(0,x.iH)(k()),C=(0,l.Fl)((()=>void 0!=V.value)),W=(0,l.Fl)((()=>{if(V.value)return new Date(1e3*V.value.time)})),U=(0,l.Fl)((()=>V.value&&V.value.vote?new Date(1e3*V.value.vote.end):void 0)),z=(0,l.Fl)((()=>W.value&&U.value?(W.value.getTime()-U.value.getTime())/1e3:void 0)),H=(0,x.iH)(void 0);function S(){var e,o,l,a;return L(this,void 0,void 0,(function*(){if(yield te(),V.value=k(),V.value&&2===(null===(o=null===(e=V.value)||void 0===e?void 0:e.vote)||void 0===o?void 0:o.type)&&void 0!==(null===(a=null===(l=V.value)||void 0===l?void 0:l.vote)||void 0===a?void 0:a.index)){J.value=!0;const e=V.value.vote,o=BigInt(V.value.vote.index);y&&(yield Y.updatePublicVotes(y,o,o));const l=t.pubPolls.get(Number(o));if(l){const t=(0,O.stringToAsset)(V.value.fund).symbol;for(let o of l)o.id==e.id&&o.end==e.end&&o.symbol.name===t.name&&o.symbol.precision==t.precision&&o.chain==V.value.chain&&o.contract===V.value.contract&&o.options.length==e.total&&(H.value=o)}J.value=!1}}))}const I=(0,x.iH)(t.historyRecipientInput?t.historyRecipientInput:""),D=(0,l.Fl)({get:()=>I.value,set:e=>{I.value=e,((0,R.isNameValid)(e)||e.length>52&&j.b.isValidPublic(e))&&t.setHistoryRecipientInput(e)}}),F=(0,l.Fl)((()=>e.brightStyle)),Y=new $.TrxUpdater,J=(0,x.iH)(!1),X=(0,x.iH)(!1),ee=(0,x.iH)(-1);function te(){return L(this,void 0,void 0,(function*(){if(J.value)return;const e=T.value;e?J.value||(J.value=!0,y&&(yield Y.updateAllIncomings(e,y)),J.value=!1):A.Z.create({type:"negative",message:o("noSenderDefined"),caption:o("enterUserFirst"),position:"top"})}))}const oe=(0,l.Fl)((()=>[{name:"type",align:"left",label:"",field:"type"},{name:"id",align:"left",label:"Id",field:"id",sortable:!0},{name:"sender",align:"left",label:o("sender"),field:"sender",sortable:!0},{name:"fund",align:"left",label:o("fund"),field:"fund",sortable:!0},{name:"vote",align:"left",label:o("selection"),field:"vote"},{name:"option",align:"left",label:"Option",field:"option"}])),le=(0,l.Fl)((()=>t.user[T.value]&&C.value?t.user[T.value].inHistory.filter((e=>ae(e))):[]));function ae(e){if(V.value&&V.value.vote)return!(!e.vote||e.chain!=V.value.chain||e.contract!=V.value.contract||e.vote.id!=V.value.vote.id||e.vote.end!=V.value.vote.end||e.vote.total!=V.value.vote.total||e.vote.type!=V.value.vote.type||!(e.time==V.value.time||e.time<=1))}function ie(e,t){let o=t?{user:e.recipient,from:e.sender,id:e.id,chain:e.chain}:{user:e.sender,to:e.recipient,id:e.id,chain:e.chain};a.push({name:"action",query:o})}function ne(e){return`${e.sender} ${e.recipient} ${e.id}`}const se=(0,l.Fl)((()=>{if(V.value&&V.value.vote&&!(V.value.vote.total<=0)){if(r.value){let e=Array(V.value.vote.total).fill(0),t=new Set;for(let o of le.value)if(o.vote&&!t.has(o.sender+o.vote.choice.selected)&&o.contract==f.value){const l=(0,O.stringToAsset)(o.fund);if(l.symbol.name==b.value&&l.symbol.precision==h.value){if(u.value&&o.time<=1)continue;e[o.vote.choice.selected]++,t.add(o.sender+o.vote.choice.selected)}}return e}{let e=Array(V.value.vote.total).fill(BigInt(0));for(let t of le.value)if(t.contract==f.value){const o=(0,O.stringToAsset)(t.fund);if(o.symbol.name==b.value&&o.symbol.precision==h.value&&t.vote){if(u.value&&t.time<=1)continue;e[t.vote.choice.selected]+=o.amount}}return e.map((e=>Number(e)))}}}));return(0,l.bv)((()=>{S()})),{t:o,brightStyle:F,user:T,to:D,moreAvailable:X,lastSearchId:ee,updateIn:te,loadingUpdateIn:J,eosioStore:t,showWalletDialog:t.showWalletDialog,inColumns:oe,inRows:le,shortAddress:R.shortAddress,shortenText:R.shortenText,onRowClick:ie,rowKey:ne,colorStatus:B.colorStatus,showSymbol:w,connect:y,tokenContract:f,symbol:b,precision:h,voteData:se,switchCount:r,graphUpdateKey:v,VoteColor:N.VoteColor,limit:W,activeFilter:u,isTimeover:d,isVoteOver:m,hasUserTrx:C,infoDialog:p,voteEnd:U,decisionTime:z,shrinkText:M.shrinkText,chartType:s,pubVote:H,showUser:g}}});var J=o(11639),X=o(69885),ee=o(44458),te=o(68879),oe=o(1389),le=o(22857),ae=o(31746),ie=o(31233),ne=o(67220),se=o(61357),re=o(32074),ue=o(63190),ce=o(11821),de=o(62146),me=o(69984),pe=o.n(me);const ve=(0,J.Z)(Y,[["render",W]]),we=ve;pe()(Y,"components",{QPage:X.Z,QCard:ee.Z,QBtn:te.Z,QBtnToggle:oe.Z,QIcon:le.Z,QTable:ae.Z,QTr:ie.Z,QTd:ne.Z,QAvatar:se.Z,QDialog:re.Z,QCardSection:ue.Z,QCardActions:ce.Z}),pe()(Y,"directives",{ClosePopup:de.Z})}}]);