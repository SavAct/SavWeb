"use strict";(globalThis["webpackChunksavactapp"]=globalThis["webpackChunksavactapp"]||[]).push([[356],{31526:(e,t,o)=>{o.r(t),o.d(t,{default:()=>fe});var a=o(59835),l=o(86970),n=o(61957);const i={class:"col q-mt-sm q-px-md"},s={class:"col-auto"},r={class:"row"},u={class:"full-width row"},c={class:"col wrap"},d={class:"col-auto"},m={class:"col-12 text-h6 text-left"},v={class:"col-12 text-left"},p=(0,a._)("span",{class:"q-pl-md q-pr-xs"},"Memo",-1),g={class:"q-pl-md q-pr-xs"},y={class:"q-my-md"},f=["href"],h={key:0,class:"row"},w={class:"text-no-wrap col-sm-auto col-12"},b={class:"q-mb-sm col-12"},k={key:1},V={class:"text-no-wrap"},S={key:0},C=(0,a._)("span",null,":  ",-1),T={key:2,class:"full-width"},P={class:"q-px-md q-mb-md"},x={class:"q-mt-sm"};function q(e,t,o,q,_,W){const D=(0,a.up)("q-btn"),N=(0,a.up)("q-card-section"),O=(0,a.up)("q-card"),U=(0,a.up)("key-or-name-input"),M=(0,a.up)("q-chip"),F=(0,a.up)("q-icon"),A=(0,a.up)("q-input"),I=(0,a.up)("q-toggle"),Z=(0,a.up)("q-expansion-item"),$=(0,a.up)("remaining-time"),H=(0,a.up)("date-time-input"),z=(0,a.up)("time-view"),E=(0,a.up)("transfer-data-view"),j=(0,a.up)("wallet-eosio"),Q=(0,a.up)("symbol-dialog"),K=(0,a.up)("vote-dialog"),B=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(B,{class:"column",style:{height:"100%"}},{default:(0,a.w5)((()=>[(0,a._)("div",i,[(0,a.Wm)(O,{class:"col q-my-sm card"},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{class:"row items-center justify-left"},{default:(0,a.w5)((()=>{var t;return[(0,a._)("div",s,(0,l.zw)(e.t("payOnThe")),1),(0,a.Wm)(D,{class:"col-auto q-ml-sm",dense:"",label:`${null===(t=e.chain)||void 0===t?void 0:t.name} Network`,onClick:e.showWalletDialog},null,8,["label","onClick"])]})),_:1})])),_:1}),(0,a.Wm)(O,{class:"q-my-sm card"},{default:(0,a.w5)((()=>[(0,a.Wm)(N,null,{default:(0,a.w5)((()=>[e.showSender?((0,a.wg)(),(0,a.j4)(U,{key:0,modelValue:e.sender,"onUpdate:modelValue":t[0]||(t[0]=t=>e.sender=t),outlined:"",label:e.t("sender"),walletOption:"",pubkeyOption:"",class:"q-mb-md",useAvailableWallet:""},null,8,["modelValue","label"])):(0,a.kq)("",!0),(0,a.Wm)(U,{modelValue:e.recipient,"onUpdate:modelValue":t[1]||(t[1]=t=>e.recipient=t),outlined:"",label:e.t("recipient")},null,8,["modelValue","label"])])),_:1})])),_:1}),(0,a.Wm)(O,{class:"q-my-sm card"},{default:(0,a.w5)((()=>[(0,a.Wm)(N,null,{default:(0,a.w5)((()=>[(0,a._)("div",r,[e.isVote?((0,a.wg)(),(0,a.j4)(M,{key:0,class:"q-mb-md col-grow",color:"number"==typeof e.selVote?"blue":"red","text-color":"white",icon:"poll",clickable:"",onClick:t[3]||(t[3]=t=>e.voteDialog=!0),square:""},{default:(0,a.w5)((()=>[(0,a._)("div",u,[(0,a._)("div",c,(0,l.zw)("number"==typeof e.selVote?`${e.selVote+1}. ${e.shrinkText(e.voteOptions[e.selVote],e.Screen.width/20)}`:e.t("selectVote")),1),(0,a._)("div",d,[(0,a.Wm)(D,{round:"",class:"text-white",size:"xs",icon:"done",dense:"",style:(0,l.j5)(`background-color:${"number"==typeof e.selVote?e.VoteColor[e.selVote]:"white"}`),onClick:t[2]||(t[2]=t=>e.voteDialog=!0)},null,8,["style"])])])])),_:1},8,["color"])):(0,a.kq)("",!0)]),(0,a.Wm)(A,{outlined:"","bottom-slots":"",modelValue:e.amount,"onUpdate:modelValue":t[5]||(t[5]=t=>e.amount=t),type:"number",label:e.t("amount"),class:"full-width","hide-bottom-space":""},{before:(0,a.w5)((()=>[(0,a.Wm)(F,{name:"monetization_on"})])),append:(0,a.w5)((()=>[(0,a.Wm)(D,{size:"sm",class:"row q-px-sm q-py-none q-ma-none",onClick:t[4]||(t[4]=t=>e.showSymbol=!0)},{default:(0,a.w5)((()=>[(0,a._)("div",m,(0,l.zw)(e.symbol),1),(0,a._)("div",v,(0,l.zw)(e.tokenContract),1)])),_:1})])),_:1},8,["modelValue","label"]),e.isVote?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",{key:0,class:"q-mt-md",onClick:t[7]||(t[7]=t=>e.extraMemo.active=!e.extraMemo.active)},[(0,a.Wm)(F,{name:"notes",size:"sm",color:e.extraMemo.active?"blue":""},null,8,["color"]),p,(0,a.Wm)(I,{modelValue:e.extraMemo.active,"onUpdate:modelValue":t[6]||(t[6]=t=>e.extraMemo.active=t),size:"md","unchecked-icon":"clear","checked-icon":"check"},null,8,["modelValue"])])),(0,a._)("div",null,[(0,a.wy)((0,a.Wm)(A,{outlined:"","bottom-slots":"",modelValue:e.extraMemo.value,"onUpdate:modelValue":t[9]||(t[9]=t=>e.extraMemo.value=t),label:"Memo",maxlength:"255",class:"full-width","hide-bottom-space":""},{append:(0,a.w5)((()=>[""!==e.extraMemo.value?((0,a.wg)(),(0,a.j4)(F,{key:0,name:"close",onClick:t[8]||(t[8]=t=>e.extraMemo.value=""),class:"cursor-pointer"})):(0,a.kq)("",!0)])),_:1},8,["modelValue"]),[[n.F8,e.extraMemo.active]])])])),_:1})])),_:1}),e.savPayAvailable?((0,a.wg)(),(0,a.j4)(O,{key:0,class:"q-my-sm card"},{default:(0,a.w5)((()=>[(0,a.Wm)(N,null,{default:(0,a.w5)((()=>{var o;return[e.isVote?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",{key:0,onClick:t[11]||(t[11]=t=>e.savPay=!e.savPay)},[(0,a.Wm)(F,{name:"health_and_safety",size:"sm",color:e.savPay?"blue":""},null,8,["color"]),(0,a._)("span",g,(0,l.zw)(e.t("useSavAct")),1),(0,a.Wm)(I,{modelValue:e.savPay,"onUpdate:modelValue":t[10]||(t[10]=t=>e.savPay=t),size:"md","unchecked-icon":"clear","checked-icon":"check",disable:e.isVote},null,8,["modelValue","disable"])])),(0,a.wy)((0,a._)("div",null,[(0,a.Wm)(Z,{class:(0,l.C_)(["q-mb-md",e.brightStyle?"bg-blue-grey-2":"bg-blue-grey-9"]),"expand-separator":"",label:e.t("isSavActKnown"),"expand-icon":"info"},{default:(0,a.w5)((()=>[(0,a.Wm)(O,null,{default:(0,a.w5)((()=>[(0,a.Wm)(N,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(e.t("recipientKnowsSavAct"))+" ",1),(0,a._)("div",y,(0,l.zw)(e.t("timeLimitDescr")),1),(0,a._)("div",null,[(0,a.Uk)((0,l.zw)(e.t("paymentWpHint"))+" ",1),(0,a._)("a",{href:e.t("wpLink"),target:"_blank"},(0,l.zw)(e.t("wpFileClickName")),9,f)])])),_:1})])),_:1})])),_:1},8,["label","class"]),e.isVote?((0,a.wg)(),(0,a.iD)("div",h,[(0,a._)("span",w,(0,l.zw)(e.t("voteEndTime"))+":  ",1),(0,a.Wm)($,{class:"text-no-wrap col-sm-auto col-12",modelValue:e.voteEnd,"onUpdate:modelValue":t[12]||(t[12]=t=>e.voteEnd=t),timeOverMsg:e.t("timeIsOver")},null,8,["modelValue","timeOverMsg"]),(0,a._)("div",b,(0,l.zw)(null===(o=e.voteEnd)||void 0===o?void 0:o.toString()),1)])):((0,a.wg)(),(0,a.iD)("div",k,[(0,a._)("span",V,(0,l.zw)(e.isVote?e.t("voteTime"):e.t("timelimit")),1),void 0!==e.limit?((0,a.wg)(),(0,a.iD)("span",S,[C,(0,a.Wm)($,{modelValue:e.limit,"onUpdate:modelValue":t[13]||(t[13]=t=>e.limit=t),timeOverMsg:e.t("timeIsOver")},null,8,["modelValue","timeOverMsg"])])):(0,a.kq)("",!0),(0,a.Wm)(H,{disable:e.isVote,modelValue:e.limit,"onUpdate:modelValue":t[14]||(t[14]=t=>e.limit=t)},null,8,["disable","modelValue"])])),e.isVote?((0,a.wg)(),(0,a.iD)("div",T,[(0,a._)("span",null,(0,l.zw)(e.t("punishTimeSpanSend"))+":  ",1),(0,a.Wm)(z,{class:"col",showTime:e.decisionTime,minTime:3600,belowMinMsg:e.t("minPunishTime"),valueClasses:"text-green"},null,8,["showTime","belowMinMsg"])])):(0,a.kq)("",!0)],512),[[n.F8,e.savPay]])]})),_:1})])),_:1})):(0,a.kq)("",!0)]),(0,a._)("div",P,[(0,a._)("div",x,[e.inputsValid?((0,a.wg)(),(0,a.j4)(E,{key:0,sender:e.sender,recipient:e.to,quantity:e.quantity,memo:e.memo,memoActive:e.extraMemo.active||e.savPay,tokenContract:e.tokenContract},null,8,["sender","recipient","quantity","memo","memoActive","tokenContract"])):(0,a.kq)("",!0)]),(0,a.Wm)(O,{class:"q-mt-sm card"},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{class:"row justify-between"},{default:(0,a.w5)((()=>[(0,a.Wm)(j,{class:"col q-pr-md"}),e.walletStyle?((0,a.wg)(),(0,a.j4)(D,{key:0,class:"col-12 col-sm-auto q-mt-md",label:"Send","icon-right":"send",color:"blue",onClick:e.confirm,disable:e.loadingConfirm},null,8,["onClick","disable"])):e.inputsValid?((0,a.wg)(),(0,a.j4)(D,{key:1,class:"col-12 q-mt-sm",size:"sm","no-caps":"",dense:"",label:e.t("alreadyPayed"),onClick:e.alreadyPayed},null,8,["label","onClick"])):(0,a.kq)("",!0)])),_:1})])),_:1})]),(0,a.Wm)(Q,{modelValue:e.showSymbol,"onUpdate:modelValue":t[15]||(t[15]=t=>e.showSymbol=t),contract:e.tokenContract,"onUpdate:contract":t[16]||(t[16]=t=>e.tokenContract=t),symbol:e.symbol,"onUpdate:symbol":t[17]||(t[17]=t=>e.symbol=t),connect:e.connect,precision:e.fixed,"onUpdate:precision":t[18]||(t[18]=t=>e.fixed=t)},null,8,["modelValue","contract","symbol","connect","precision"]),(0,a.Wm)(K,{modelValue:e.voteDialog,"onUpdate:modelValue":t[19]||(t[19]=t=>e.voteDialog=t),options:e.voteOptions,"onUpdate:options":t[20]||(t[20]=t=>e.voteOptions=t),selected:e.selVote,"onUpdate:selected":t[21]||(t[21]=t=>e.selVote=t)},null,8,["modelValue","options","selected"])])),_:1})}var _=o(28045),W=o(46684),D=o(92868),N=o(41258),O=o(47045),U=o(72902),M=o(86009),F=o(89889),A=o(6827),I=o(38346),Z=o(5980),$=o(60499),H=o(3390),z=o(28339),E=o(27712),j=o(62659),Q=o(94345),K=o(72354),B=o(7580),L=o(53103),G=o(74544),R=o(39882),J=o.n(R),X=o(86350),Y=o(47983),ee=o(17779),te=o(40270)["Buffer"],oe=function(e,t,o,a){function l(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,n){function i(e){try{r(a.next(e))}catch(t){n(t)}}function s(e){try{r(a["throw"](e))}catch(t){n(t)}}function r(e){e.done?o(e.value):l(e.value).then(i,s)}r((a=a.apply(e,t||[])).next())}))};const ae=(0,a.aZ)({name:"page-send",components:{WalletEosio:_["default"],TransferDataView:W["default"],KeyOrNameInput:D["default"],DateTimeInput:N["default"],RemainingTime:O["default"],SymbolDialog:U["default"],VoteDialog:M["default"],TimeView:F["default"]},setup(){var e,t,o,l,n,i;const s=(0,a.FN)(),r=(0,E.QT)({useScope:"global"}).t.bind(this),u=(0,j.r)(),c=(0,H.b)(),d=(0,z.yj)(),m=(0,z.tv)(),v=(0,$.iH)(!1),p=(0,a.Fl)((()=>c.brightStyle)),g=(0,a.Fl)((()=>u.walletUser)),y=(0,a.Fl)((()=>u.walletUsers)),f=(0,a.Fl)((()=>u.getWalletStyle)),h=(0,$.iH)(!1),w=(0,a.Fl)({set:e=>{if(e){if(!U())return}else if(le.value.length>13||ie.value.length>13)return void A.Z.create({type:"negative",message:r("keyUseSavPay"),position:"top"});h.value=e},get:()=>h.value}),b=(0,$.iH)(),k=(0,a.Fl)((()=>{if(0==ie.value.length)return ee.log("No recipient"),!1;if((le.value.length>13||ie.value.length>13)&&!w.value)return ee.log("SavPay has to be activated on payments from or to a key"),!1;if(ue.value<0)return ee.log("No amount"),!1;if(w.value){if(!U())return ee.log("SavPay is not available"),!1;if(0==le.value.length)return ee.log("No sender"),!1;if(!b.value||b.value.getTime()<Date.now())return ee.log("Time limit is already over"),!1}return ee.log("Every input is valid"),!0})),V=(0,a.Fl)((()=>w.value?u.selectedConnect&&u.selectedConnect.chainParams.savpayContract?u.selectedConnect.chainParams.savpayContract:"":ie.value)),S=d.query;ee.log("payment Options",S),void 0!==S.requestId&&c.updateBrowserPayment(S.requestId,!0,!1);let C=void 0!=S.from?S.from:"";0==C.length&&void 0!=g.value&&void 0!=g.value.name?C=g.value.name:C.length>13&&(C.startsWith("EOS")||C.startsWith("PUP"))&&(w.value=!0);let T=!!S.V&&"string"==typeof S.V;const P=(0,$.iH)(!1);let x=[];const q=(0,$.iH)();let _,W;if(T&&S.V){const e=(new TextDecoder).decode(J().decode(S.V)).toString();_=e.charAt(0).charCodeAt(0),W=(0,X.uint32StringToNumber)(e.substring(1,5));const t=e.charAt(5).charCodeAt(0);x=(0,X.OneStringToStringArray)(e.substring(6)),t!=x.length?(T=!1,ee.log(`Wrong amount voteId ${_} choisesAmount`,t)):(ee.log("voteOptions",x),P.value=!0)}const D=(0,a.Fl)((()=>b.value?new Date(1e3*W):void 0)),N=(0,a.Fl)((()=>b.value&&D.value?(b.value.getTime()-D.value.getTime())/1e3:void 0)),O=(0,a.Fl)((()=>w.value||void 0==S.to||C.length>0));function U(){return!1!==M()||(A.Z.create({type:"negative",message:r("errSavPayNotAvailable"),position:"top"}),h.value=!1,!1)}function M(){if(u.selectedConnect&&u.selectedConnect.chainParams)return!!u.selectedConnect.chainParams.savpayContract}const F=(0,a.Fl)((()=>{var e;return null===(e=u.selectedConnect)||void 0===e?void 0:e.chainParams}));(0,Z.iniSelectedChain)(S.chain,void 0==F.value?ke:void 0);const R=(0,$.iH)(void 0!=S.from?"wallet":"third"),ae=(0,$.iH)(C),le=(0,a.Fl)({get:()=>ae.value,set:e=>{e.length>13&&(w.value=!0),ae.value=e}}),ne=(0,$.iH)(void 0!=S.to?S.to:""),ie=(0,a.Fl)({get:()=>ne.value,set:e=>{e.length>13&&(w.value=!0),ne.value=e}}),se=(0,$.iH)(!1);ie.value.length>13&&(ie.value.startsWith("EOS")||ie.value.startsWith("PUP"))&&(w.value=!0);const re=(0,$.iH)((null===(t=null===(e=u.selectedConnect)||void 0===e?void 0:e.chainParams.systemToken)||void 0===t?void 0:t.contract)?u.selectedConnect.chainParams.systemToken.contract:"eosio.token"),ue=(0,$.iH)(0),ce=(0,$.iH)((null===(l=null===(o=u.selectedConnect)||void 0===o?void 0:o.chainParams.systemToken)||void 0===l?void 0:l.symbol)?u.selectedConnect.chainParams.systemToken.symbol:"EOS"),de=(0,$.iH)((null===(i=null===(n=u.selectedConnect)||void 0===n?void 0:n.chainParams.systemToken)||void 0===i?void 0:i.precision)?u.selectedConnect.chainParams.systemToken.precision:4),me=(0,a.Fl)({set:e=>{if(0==e.trim().length)return;let t=e.indexOf(".")+1,o=e.indexOf(" ",t);if(-1==o)for(let l=t;l<e.length;++l)if(-1=="0123456789".indexOf(e[l])){e=e.slice(0,l)+" "+e.slice(l),o=l;break}let a=o-t;de.value=t>-1&&a>=0?a:0,-1==o||o>=e.length||(ue.value=parseFloat(e.substring(0,o)),ce.value=e.substring(o+1))},get:()=>{const e=parseFloat(ue.value.toString());if(e>=0&&!isNaN(e)){const t=e.toFixed(de.value);return`${t} ${ce.value}`}return""}});if("string"==typeof S.pay){const e=S.pay.split(" ");e.length>3||e.length<2?ee.log('Got invalid asset by query parameter "pay"'):(3==e.length&&((0,Q.isNameValid)(e[3])?ee.log('Got invalid token contract by query parameter "pay"'):re.value=e[2]),me.value=`${e[0]} ${e[1]}`)}let ve="";void 0!=S.M?ve=(new TextDecoder).decode(J().decode(S.M)).toString():void 0!=S.MEMO?ve=te.from(S.MEMO,"base64").toString():void 0!=S.m?ve=S.m:void 0!=S.memo&&(ve=S.memo);const pe=(0,$.iH)({active:""!=ve,value:ve});function ge(){if(b.value){let e;if(pe.value.active&&pe.value.value.length>0)e=`;${pe.value.value}`;else if(T&&"number"==typeof q.value){const t=String.fromCharCode(_),o=(0,X.numberToUint32String)(Math.floor(W)),a=String.fromCharCode(x.length),l=String.fromCharCode(q.value),n=(0,X.SetStringLengthInforntOfString)(x[q.value]),i=`${t}${o}${a}${l}${n}`,s=(new TextEncoder).encode(i);e=":"+J().encode(s)}else e="";return`${le.value}@${ie.value}!${(0,B.base58Time)(b.value.getTime()/1e3)}${e}`}return""}const ye=(0,a.Fl)((()=>w.value?ge():pe.value.active?pe.value.value:"")),fe=(0,a.Fl)((()=>u.selectedConnect));if(void 0!=S.t||void 0!=S.dt||void 0!=S.T||void 0!=S.DT){let e;void 0!=S.t||void 0!=S.dt?e=void 0!=S.t?S.t:S.dt:(e=void 0!=S.T?S.T:S.DT,e=(0,B.base58TimeToNumber)(e));let t=1e3*("number"==typeof e?e:Number.parseInt(e));isNaN(t)||(void 0==S.t&&void 0==S.T&&(t=Date.now()+t),b.value=new Date(t),w.value=!0)}function he(){var e,t,o;return oe(this,void 0,void 0,(function*(){if(!0===se.value)return;se.value=!0,null===(e=null===s||void 0===s?void 0:s.proxy)||void 0===e||e.$forceUpdate();const a=u.selectedConnect;if(!a)return void(se.value=!1);if(w.value&&!U())return void(se.value=!1);const l=w.value;if(0==ue.value)return ee.log("Amount can not be 0"),A.Z.create({type:"negative",message:r("errNoZeroAmount"),position:"top"}),void(se.value=!1);le.value=le.value.trim(),ie.value=ie.value.trim();const n=null===(t=(0,Q.StringToAsset)(me.value))||void 0===t?void 0:t.amount;if("undefined"==typeof n)return void(se.value=!1);const i={sender:le.value,recipient:ie.value,quantity:me.value,amount:n,tokenContract:re.value,time:b.value?b.value.getTime()/1e3:-1,memo:ye.value};if(void 0==g.value)return A.Z.create({message:r("errSelectWallet"),position:"top"}),Ve(),void(se.value=!1);if((yield g.value.getChainId())!=(null===(o=F.value)||void 0===o?void 0:o.chainId))return A.Z.create({message:r("errWrongWalletChain"),position:"top"}),void(se.value=!1);if(!k.value)return A.Z.create({type:"negative",message:r("notAllValid"),position:"top"}),void(se.value=!1);let c=!1;if(void 0!=g.value.name&&g.value.name.length>0){if(!l&&i.sender&&(0,Q.isNameValid)(i.sender)&&g.value.name!=i.sender)return A.Z.create({message:r("errWrongWalletUser"),position:"top"}),void(se.value=!1);let e=i.sender==g.value.name?ye.value.substring(ye.value.indexOf("@")):ye.value;const t={isError:!1};let o=yield Z.Connect.sendCustomAsset(t,g.value,{from:g.value.name,to:V.value,quantity:i.quantity,memo:e},i.tokenContract,!1,g.value.permission);if((0,K.trxSigningErrorHandling)(t,o,r)&&a){const e=l?yield we(a,i.recipient):"-1";if(yield(0,K.broadcastTrx)(t,a,o,r)){if(l){if(i.memo.length>0){const e=i.memo.indexOf(";"),t=i.memo.indexOf(":");let o=-1==t||-1!=e&&e<t?e:t;i.memo=o>0?i.memo.substring(o+1):""}const o=Date.now();(yield be(a,e,i))?(ee.log(r("savPayFound")),Date.now()-o<5e3&&t.notify?t.notify({type:"positive",message:r("savPayFound")}):A.Z.create({type:"positive",message:r("savPayFound"),position:"top"}),c=!0):(ee.log(r("savPayTrxNotFound")),A.Z.create({type:"negative",message:r("savPayTrxNotFound"),position:"top"}))}else c=!0;se.value=!1,ke(!0===c&&{to:i.recipient,from:i.sender.length>0?i.sender:void 0,t:-1==i.time?void 0:i.time,memo:i.memo,pay:`${i.quantity} ${i.tokenContract}`,chain:a.chainParams.shortName?a.chainParams.shortName:a.chainParams.chainId})}}}else A.Z.create({message:r("errSetUserOfWallet"),position:"top"});se.value=!1}))}function we(e,t){return oe(this,void 0,void 0,(function*(){let o,a;if((0,Q.isNameValid)(t))o=String((0,B.nameToUint64)(t)),a="name";else{const e=L.PublicKey.fromString(t);o=String((0,B.splitPubKeyToScopeAndTableVec)(e).scope),a="key"}const l=yield e.get_table_rows({code:e.chainParams.savpayContract,table:"data",scope:a,lower_bound:o,upper_bound:o});if(l.rows.length>0){const e=l.rows[0];return String(e.nextId)}return String(0)}))}function be(e,t,o){var a,l;return oe(this,void 0,void 0,(function*(){let n,i=t,s=0;if((0,Q.isNameValid)(o.sender))n=(0,B.nameToFromHex)(o.sender);else{const e=L.PublicKey.fromString(o.sender);o.sender=e.toString(),n=(0,B.hexWithTypeOfPubKey)(e)}try{if((0,Q.isNameValid)(o.recipient))while(1){const t=yield e.get_table_rows({code:e.chainParams.savpayContract,table:"pay2name",scope:o.recipient,lower_bound:i,limit:200});if(t.rows.length>0){for(const l of t.rows)if(l.from==n&&String(l.orisent)==String(o.amount)&&l.time==o.time&&l.memo==o.memo){const t=null===(a=(0,Q.StringToAsset)(l.fund))||void 0===a?void 0:a.symbol;if(!t)continue;const n={sender:o.sender,recipient:o.recipient,id:Number(l.id),fund:l.fund,orifund:(0,Q.AssetToString)({amount:l.orisent,symbol:t}),memo:l.memo,ramBy:l.ramBy,type:l.type,time:l.time,contract:l.contract,lastUpdate:Date.now(),removed:!1,chain:e.chainParams.shortName?e.chainParams.shortName:e.chainParams.chainId};return u.updateHistoryInTrx(o.recipient,n),u.updateHistoryOutTrx(o.sender,n),!0}i=String(t.rows[t.rows.length-1].id+1)}if(!(s<21))return!1;yield(0,G.sleep)(s<4?500:s<10?1e3:2e3),s++}else{const t=L.PublicKey.fromString(o.recipient),a=(0,B.splitPubKeyToScopeAndTableVec)(t);o.recipient=t.toString();while(1){const t=yield e.get_table_rows({code:e.chainParams.savpayContract,table:"pay2key",scope:String(a.scope),lower_bound:i,limit:200});if(t.rows.length>0){for(const i of t.rows)if(i.from==n&&i.to==a.tableVec&&String(i.orisent)==String(o.amount)&&i.time==o.time&&i.memo==o.memo){const t=null===(l=(0,Q.StringToAsset)(i.fund))||void 0===l?void 0:l.symbol;if(!t)continue;const a={sender:o.sender,recipient:o.recipient,id:Number(i.id),fund:i.fund,orifund:(0,Q.AssetToString)({amount:i.orisent,symbol:t}),memo:i.memo,ramBy:i.ramBy,type:i.type,time:i.time,contract:i.contract,lastUpdate:Date.now(),removed:!1,chain:e.chainParams.shortName?e.chainParams.shortName:e.chainParams.chainId};return u.updateHistoryInTrx(o.recipient,a),u.updateHistoryOutTrx(o.sender,a),!0}i=String(t.rows[t.rows.length-1].id+1)}if(!(s<21))return!1;yield(0,G.sleep)(s<4?500:s<10?1e3:2e3),s++}}}catch(r){return ee.log("Error on loadSavPayTrx"),!1}}))}function ke(e=!1){ee.log("Go back"),void 0!==S.requestId&&c.updateBrowserPayment(S.requestId,!1,e),history.length>2?m.back():m.push({name:"transfer"})}function Ve(){var e;if(void 0==F.value)return void A.Z.create({type:"negative",message:r("noChainDefined"),position:"top"});const t={payment:{to:ie.value,from:le.value,amount:ue.value,symbol:ce.value,memo:ve},chainId:null===(e=F.value)||void 0===e?void 0:e.chainId,show:!0};u.setWalletDialog(t)}const Se=(0,$.iH)(T||w.value||"string"!=typeof S.to||"t"in S||"T"in S||"dt"in S||"DT"in S);function Ce(){const e=u.selectedConnect;if(!e)return void A.Z.create({type:"negative",message:r("noChainDefined"),position:"top"});const t={to:ie.value,from:le.value.length>0?le.value:void 0,t:w.value&&b.value?b.value.getTime()/1e3:void 0,memo:ye.value,pay:`${me.value} ${re.value}`,chain:e.chainParams.shortName?e.chainParams.shortName:e.chainParams.chainId};ke(t)}return{t:r,brightStyle:p,selectMethod:R,chain:F,connect:fe,sender:le,recipient:ie,to:V,amount:ue,fixed:de,symbol:ce,tokenContract:re,extraMemo:pe,memo:ye,savPay:w,limit:b,confirm:he,loadingConfirm:se,walletStyle:f,quantity:me,walletLogout:u.walletLogout,showWalletDialog:u.showWalletDialog,walletUsers:y,walletUser:g,selectWallet:Ve,inputsValid:k,showSymbol:v,showSender:O,isVote:T,voteOptions:x,selVote:q,voteDialog:P,shrinkText:X.shrinkText,Screen:I.Z,decisionTime:N,voteEnd:D,VoteColor:Y.VoteColor,savPayAvailable:Se,alreadyPayed:Ce}}});var le=o(11639),ne=o(69885),ie=o(44458),se=o(63190),re=o(68879),ue=o(57691),ce=o(13119),de=o(22857),me=o(23175),ve=o(50651),pe=o(69984),ge=o.n(pe);const ye=(0,le.Z)(ae,[["render",q]]),fe=ye;ge()(ae,"components",{QPage:ne.Z,QCard:ie.Z,QCardSection:se.Z,QBtn:re.Z,QChip:ue.Z,QInput:ce.Z,QIcon:de.Z,QToggle:me.Z,QExpansionItem:ve.Z})}}]);