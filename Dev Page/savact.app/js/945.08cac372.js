"use strict";(globalThis["webpackChunksavactapp"]=globalThis["webpackChunksavactapp"]||[]).push([[945],{61207:(e,t,o)=>{o.r(t),o.d(t,{default:()=>ee});var n=o(59835),a=o(86970);const i={class:"row justify-between reverse q-mt-md"},l={class:"col-12 col-sm-5 col-md-3 q-px-sm"},s={class:"row justify-between"},r={class:"col-12"},c={class:"col-12 text-h6 text-left"},u={class:"col-12 text-left"},d={class:"col q-pr-sm"},m={class:"col-auto"},p={class:"text-center"},v={class:"full-width row flex-center q-gutter-sm"};function y(e,t,o,y,w,h){const g=(0,n.up)("q-btn"),f=(0,n.up)("q-card"),b=(0,n.up)("key-or-name-input"),k=(0,n.up)("q-tooltip"),_=(0,n.up)("vote-tool-tip"),T=(0,n.up)("q-icon"),C=(0,n.up)("q-item-section"),S=(0,n.up)("q-item-label"),q=(0,n.up)("remaining-time"),U=(0,n.up)("q-item"),I=(0,n.up)("q-td"),P=(0,n.up)("q-tr"),x=(0,n.up)("q-table"),W=(0,n.up)("symbol-dialog"),H=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(H,{class:"justify-evenly",style:{position:"relative",height:"100%"}},{default:(0,n.w5)((()=>[(0,n._)("div",i,[(0,n._)("div",l,[(0,n.Wm)(f,{class:"card q-px-md q-py-md q-mb-md items-center"},{default:(0,n.w5)((()=>{var o;return[(0,n._)("div",s,[(0,n.Wm)(g,{class:"col-12 q-px-md q-mb-sm",dense:"",label:`${null===(o=e.chain)||void 0===o?void 0:o.name} Network`,onClick:e.showWalletDialog,outline:""},null,8,["label","onClick"]),(0,n._)("div",r,[(0,n.Wm)(g,{size:"sm",class:"row q-px-sm q-py-none",onClick:t[0]||(t[0]=t=>e.showSymbol=!0),outline:""},{default:(0,n.w5)((()=>[(0,n._)("div",c,(0,a.zw)(e.symbol),1),(0,n._)("div",u,(0,a.zw)(e.tokenContract),1)])),_:1})])])]})),_:1})]),(0,n.Wm)(x,{title:"Incommings",class:"q-mx-sm card col",rows:e.inRows,columns:e.inColumns,"row-key":e.rowKey,color:"amber",loading:e.loadingUpdateIn,"no-data-label":e.t("hintHistoryUse")},{top:(0,n.w5)((()=>[(0,n._)("div",d,[(0,n.Wm)(b,{modelValue:e.recipient,"onUpdate:modelValue":t[1]||(t[1]=t=>e.recipient=t),outlined:"",label:e.t("recipient"),dense:""},null,8,["modelValue","label"])]),(0,n._)("div",m,[(0,n.Wm)(g,{icon:"update",label:"In",loading:e.loadingUpdateIn,outline:"",onClick:t[2]||(t[2]=t=>e.updateIn()),disable:e.loadingUpdateIn},{default:(0,n.w5)((()=>[(0,n.Wm)(k,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(e.t("update")),1)])),_:1})])),_:1},8,["loading","disable"])])])),body:(0,n.w5)((t=>[(0,n.Wm)(P,{props:t,class:(0,a.C_)(["cursor-pointer",t.row.removed?e.brightStyle?"bg-grey":"bg-grey-10":""]),onClick:o=>e.onRowClick(t.row)},{default:(0,n.w5)((()=>[(0,n.Wm)(_,{poll:t.row},null,8,["poll"]),(0,n.Wm)(I,{key:"id",colspan:"4",props:t},{default:(0,n.w5)((()=>[(0,n.Wm)(U,{class:"full-width q-px-none"},{default:(0,n.w5)((()=>[(0,n.Wm)(C,{avatar:"",class:"items-center"},{default:(0,n.w5)((()=>[(0,n.Wm)(T,{color:"blue",name:"equalizer"}),(0,n._)("div",p,"#"+(0,a.zw)(t.row.id),1)])),_:2},1024),(0,n.Wm)(C,{class:"q-mr-lg"},{default:(0,n.w5)((()=>{var o,i;return[void 0==(null===(o=t.row.options[0])||void 0===o?void 0:o.top)?((0,n.wg)(),(0,n.j4)(S,{key:0,class:"shorten"},{default:(0,n.w5)((()=>[(0,n.Uk)("-")])),_:1})):0==t.row.options[0].top.msg.length?((0,n.wg)(),(0,n.j4)(S,{key:1,class:"shorten"},{default:(0,n.w5)((()=>[e.$q.screen.lt.sm?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Uk)((0,a.zw)(e.t("selection").substring(0,1))+".",1)],64)):((0,n.wg)(),(0,n.iD)(n.HY,{key:1},[(0,n.Uk)((0,a.zw)(e.t("selection")),1)],64)),(0,n.Uk)(" "+(0,a.zw)(t.row.options[0].index+1),1)])),_:2},1024)):((0,n.wg)(),(0,n.j4)(S,{key:2,class:"shorten"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(t.row.options[0].top.msg),1)])),_:2},1024)),void 0==(null===(i=t.row.options[1])||void 0===i?void 0:i.top)?((0,n.wg)(),(0,n.j4)(S,{key:3,class:"shorten",caption:"",lines:"2"},{default:(0,n.w5)((()=>[(0,n.Uk)("-")])),_:1})):0==t.row.options[1].top.msg.length?((0,n.wg)(),(0,n.j4)(S,{key:4,class:"shorten",caption:"",lines:"2"},{default:(0,n.w5)((()=>[e.$q.screen.lt.sm?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Uk)((0,a.zw)(e.t("selection").substring(0,1))+".",1)],64)):((0,n.wg)(),(0,n.iD)(n.HY,{key:1},[(0,n.Uk)((0,a.zw)(e.t("selection")),1)],64)),(0,n.Uk)(" "+(0,a.zw)(t.row.options[1].index+1),1)])),_:2},1024)):((0,n.wg)(),(0,n.j4)(S,{key:5,class:"shorten",caption:"",lines:"2"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(t.row.options[1].top.msg),1)])),_:2},1024))]})),_:2},1024),(0,n.Wm)(C,{side:"",top:""},{default:(0,n.w5)((()=>[(0,n.Wm)(S,{caption:""},{default:(0,n.w5)((()=>[(0,n.Wm)(q,{"model-value":new Date(1e3*Number(t.row.end)),timeOverMsg:e.t("timeOver"),short:""},null,8,["model-value","timeOverMsg"])])),_:2},1024),(0,n.Wm)(S,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(t.row.sum.votes.active)+" 👍 "+(0,a.zw)(e.AssetToString({amount:BigInt(t.row.sum.amount.active),symbol:t.row.symbol})),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"])])),_:2},1032,["props","class","onClick"])])),"no-data":(0,n.w5)((({message:e})=>[(0,n._)("div",v,[(0,n._)("span",null,(0,a.zw)(e),1)])])),_:1},8,["rows","columns","row-key","loading","no-data-label"])]),(0,n.Wm)(W,{modelValue:e.showSymbol,"onUpdate:modelValue":t[3]||(t[3]=t=>e.showSymbol=t),contract:e.tokenContract,"onUpdate:contract":t[4]||(t[4]=t=>e.tokenContract=t),symbol:e.symbol,"onUpdate:symbol":t[5]||(t[5]=t=>e.symbol=t),connect:e.connect,precision:e.precision,"onUpdate:precision":t[6]||(t[6]=t=>e.precision=t)},null,8,["modelValue","contract","symbol","connect","precision"])])),_:1})}var w=o(92868),h=o(98514),g=o(47045),f=o(72902),b=o(60499),k=o(27712),_=o(6827),T=o(62659),C=o(94345),S=o(7580),q=o(65211),U=o(53103),I=o(74544),P=o(28339),x=o(10818),W=o(3390),H=o(47983),Z=o(86350),z=o(5980),D=o(17779),V=function(e,t,o,n){function a(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,i){function l(e){try{r(n.next(e))}catch(t){i(t)}}function s(e){try{r(n["throw"](e))}catch(t){i(t)}}function r(e){e.done?o(e.value):a(e.value).then(l,s)}r((n=n.apply(e,t||[])).next())}))};const A=(0,n.aZ)({name:"page-list-polls",components:{KeyOrNameInput:w["default"],VoteToolTip:h["default"],RemainingTime:g["default"],SymbolDialog:f["default"]},setup(){var e,t,o,a,i,l;const s=(0,W.b)(),r=(0,T.r)(),c=(0,k.QT)({useScope:"global"}).t.bind(this),u=(0,P.tv)(),d=(0,P.yj)(),m=d.query,p=(0,n.Fl)((()=>r.selectedConnect)),v=(0,n.Fl)((()=>{var e;return null===(e=r.selectedConnect)||void 0===e?void 0:e.chainParams}));(0,z.iniSelectedChain)(m.chain,void 0==v.value?j:void 0);const y=(0,b.iH)(!1),w=(0,b.iH)(!1),h=(0,b.iH)(!1),g=(0,b.iH)([0,0]),f=(0,b.iH)(!1),A=(0,b.iH)((null===(t=null===(e=r.selectedConnect)||void 0===e?void 0:e.chainParams.systemToken)||void 0===t?void 0:t.contract)?r.selectedConnect.chainParams.systemToken.contract:"eosio.token"),N=(0,b.iH)((null===(a=null===(o=r.selectedConnect)||void 0===o?void 0:o.chainParams.systemToken)||void 0===a?void 0:a.symbol)?r.selectedConnect.chainParams.systemToken.symbol:"EOS"),Q=(0,b.iH)((null===(l=null===(i=r.selectedConnect)||void 0===i?void 0:i.chainParams.systemToken)||void 0===l?void 0:l.precision)?r.selectedConnect.chainParams.systemToken.precision:4);if(m.token){const e=m.token.split(",");switch(e.length){case 3:A.value=e[2];case 2:Q.value=Number(e[0]),N.value=e[1];break;case 1:N.value=e[0];break;default:D.log("Wrong symbol query")}}function j(){D.log("Go back"),history.length>2?u.back():u.push({name:"vote"})}m.to&&m.to.length>0&&(m.to.length<=13&&(0,C.isNameValid)(m.to)?r.setHistoryUserInput(m.to.toLowerCase()):q.b.isValidPublic(m.to)&&r.setHistoryUserInput(m.to));const K=(0,n.Fl)({get:()=>r.historyUserInput.length>13?U.PublicKey.fromString(r.historyUserInput).toString():r.historyUserInput,set:e=>{r.setHistoryUserInput(e),e.length>0&&(D.log(history.state),d.fullPath.length>1&&u.replace({query:{to:e}}),E())}}),O=(0,n.Fl)((()=>s.brightStyle)),F=(0,b.iH)(!1),B=(0,b.iH)(!1),R=(0,b.iH)(-1);function $(e){var t,o;return V(this,void 0,void 0,(function*(){if(!p.value)return _.Z.create({type:"negative",message:c("noChainDefined"),position:"top"}),!1;try{let n=!0,a=0;const i=200;while(n){const l=Date.now();if((0,C.isNameValid)(e)){const o=yield p.value.get_table_rows({code:p.value.chainParams.savpayContract,table:"pay2name",scope:e,lower_bound:String(a),limit:i,reverse:!0});if(o.rows.length>0)for(const n of o.rows){const o=null===(t=(0,C.StringToAsset)(n.fund))||void 0===t?void 0:t.symbol;void 0!=o&&r.updateHistoryInTrx(e,{sender:(0,S.hexTypeOfPubKeyToNameOrKeyStr)(n.from),recipient:e,id:n.id,fund:n.fund,orifund:(0,C.AssetToString)({amount:n.orisent,symbol:o}),memo:n.memo,ramBy:n.ramBy,type:n.type,time:n.time,contract:n.contract,lastUpdate:l,removed:!1,chain:p.value.chainParams.shortName?p.value.chainParams.shortName:p.value.chainParams.chainId})}n=o.more}else{if(!q.b.isValidPublic(e))return _.Z.create({type:"negative",message:e.length<13?c("invalidAcc"):c("invalidPub"),position:"top"}),!1;{const t=U.PublicKey.fromString(e),s=(0,S.splitPubKeyToScopeAndTableVec)(t);e=e.toString();const c=yield p.value.get_table_rows({code:p.value.chainParams.savpayContract,table:"pay2key",scope:s.scope.toString(),lower_bound:String(a),limit:i,reverse:!0});if(c.rows.length>0)for(const n of c.rows){const t=null===(o=(0,C.StringToAsset)(n.fund))||void 0===o?void 0:o.symbol;void 0!=t&&r.updateHistoryInTrx(e,{sender:(0,S.hexTypeOfPubKeyToNameOrKeyStr)(n.from),recipient:e,id:n.id,fund:n.fund,orifund:(0,C.AssetToString)({amount:n.orisent,symbol:t}),memo:n.memo,ramBy:n.ramBy,type:n.type,time:n.time,contract:n.contract,lastUpdate:l,removed:!1,chain:p.value.chainParams.shortName?p.value.chainParams.shortName:p.value.chainParams.chainId})}n=c.more}}a+=i,yield(0,I.sleep)(1e3)}}catch(n){return D.log("Error on requesting data",n),!1}return!0}))}function E(){return V(this,void 0,void 0,(function*(){F.value||(0!=K.value.length?F.value||(F.value=!0,yield $(K.value),F.value=!1):_.Z.create({type:"negative",message:c("noRecipientDefined"),caption:c("enterUserFirst"),position:"top"}))}))}const Y=(0,n.Fl)((()=>[{name:"end",align:"left",label:"End",field:"end",sortable:!0},{name:"id",align:"left",label:"Id",field:"id",sortable:!0},{name:"fund",align:"left",label:c("fund"),field:"sum",sort:(e,t)=>e.amount.active-t.amount.active,sortable:!0},{name:"votes",align:"left",label:"Votes",field:"sum",sort:(e,t)=>e.votes.active-t.votes.active,sortable:!0}])),M=(0,n.Fl)((()=>{var e;return null===(e=r.user[K.value])||void 0===e?void 0:e.polls.filter((e=>{if(e.contract==A.value&&e.symbol.name==N.value&&e.symbol.precision==Q.value)return e.chain==p.value.chainParams.shortName||e.chain==p.value.chainParams.chainId}))}));function L(e){let t=r.user[K.value].inHistory.find((t=>{if(t.chain==e.chain&&t.contract==e.contract){const o=(0,C.StringToAsset)(t.fund);if(o&&o.symbol.name==e.symbol.name&&o.symbol.precision==e.symbol.precision){const o=(0,H.getVoteDataFromMemo)(t.memo);return o.end==e.end&&o.id==e.id&&o.total==e.options.length}}return!1}));if(t){let o={to:K.value,id:null===t||void 0===t?void 0:t.id,chain:e.chain};u.push({name:"vote-result",query:o})}else _.Z.create({type:"negative",message:"Error",caption:c("noTrxFound"),position:"top"})}function G(e){return`${e.sender} ${e.recipient} ${e.id}`}function J(e){return e.sort(((e,t)=>t.top.amount-e.top.amount))}function X(e){return new Date(1e3*e)}return K.value.length>0&&E(),{t:c,chain:v,brightStyle:O,moreAvailable:B,lastSearchId:R,updateIn:E,loadingUpdateIn:F,eosioStore:r,showWalletDialog:r.showWalletDialog,inRows:M,inColumns:Y,shortAddress:C.shortAddress,shortenText:C.shortenText,onRowClick:L,rowKey:G,colorStatus:x.colorStatus,showSymbol:f,connect:p,tokenContract:A,symbol:N,precision:Q,switchCount:y,graphUpdateKey:g,VoteColor:H.VoteColor,isVoteOver:w,infoDialog:h,shrinkText:Z.shrinkText,recipient:K,sortDownOptions:J,AssetToString:C.AssetToString,getDateFromEndTime:X}}});var N=o(11639),Q=o(69885),j=o(44458),K=o(68879),O=o(77580),F=o(46858),B=o(31233),R=o(67220),$=o(61357),E=o(490),Y=o(76749),M=o(22857),L=o(33115),G=o(69984),J=o.n(G);const X=(0,N.Z)(A,[["render",y],["__scopeId","data-v-5e980f5c"]]),ee=X;J()(A,"components",{QPage:Q.Z,QCard:j.Z,QBtn:K.Z,QTable:O.Z,QTooltip:F.Z,QTr:B.Z,QTd:R.Z,QAvatar:$.Z,QItem:E.Z,QItemSection:Y.Z,QIcon:M.Z,QItemLabel:L.Z})}}]);